{"ast":null,"code":"/* eslint-disable class-methods-use-this */\n\n/* eslint-disable max-classes-per-file */\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport clonedeep from 'lodash.clonedeep';\nimport createProxyRoot from './helpers/proxyRoot';\nimport { EventProvider } from './components/EventContext';\nimport registeredPlugins from './plugins/plugins';\nimport getSerialized from './helpers/getSerialized';\n\nclass WebComponentFactory {\n  constructor(componentProperties, rootComponent, shadow, anonymousSlot, plugins, connectCallback) {\n    this.componentProperties = componentProperties;\n    this.rootComponent = rootComponent;\n    this.shadow = shadow;\n    this.anonymousSlot = anonymousSlot;\n    this.plugins = plugins;\n    this.connectCallback = connectCallback;\n    this.componentAttributes = {};\n    this.reflectPropertiesToAttributes();\n  }\n  /**\n   * All properties with primitive values are added to attributes.\n   */\n\n\n  reflectPropertiesToAttributes() {\n    Object.entries(this.componentProperties).forEach(([key, value]) => {\n      if (typeof value !== 'number' && typeof value !== 'string' && typeof value !== 'boolean') {\n        return;\n      }\n\n      this.componentAttributes[key.toLowerCase()] = {\n        property: key,\n        value\n      };\n    });\n  }\n  /**\n   * Create new class that will serve as the Web Component.\n   */\n\n\n  create() {\n    const factory = this;\n    return class WebComponent extends HTMLElement {\n      constructor() {\n        super();\n        this.initialProperties = clonedeep(factory.componentProperties);\n        this.properties = {};\n        this.hasConnected = false;\n        /**\n         * Dispatch an event from the Web Component\n         */\n\n        this.eventDispatcher = event => {\n          this.dispatchEvent(event);\n        };\n\n        this.transferInitialProperties();\n        this.subscribeToProperties();\n      }\n      /**\n       * Observe attributes for changes.\n       * Part of the Web Component Standard.\n       */\n\n\n      static get observedAttributes() {\n        return Object.keys(factory.componentAttributes);\n      }\n      /**\n       * Web Component gets mounted on the DOM.\n       */\n\n\n      connectedCallback() {\n        var _a;\n\n        this.mountReactApp({\n          initial: true\n        });\n        this.hasConnected = true;\n        (_a = factory.connectCallback) === null || _a === void 0 ? void 0 : _a.call(factory, this);\n      }\n      /**\n       * When an attribute is changed, this callback function is called.\n       * @param name name of the attribute\n       * @param oldValue value before change\n       * @param newValue value after change\n       */\n\n\n      attributeChangedCallback(name, oldValue, newValue) {\n        if (!this.hasConnected) {\n          return;\n        }\n\n        if (oldValue === newValue) {\n          return;\n        }\n\n        if (!factory.componentAttributes.hasOwnProperty(name)) {\n          return;\n        }\n\n        const propertyName = factory.componentAttributes[name].property;\n        this.properties[propertyName] = getSerialized(newValue);\n        this.mountReactApp();\n      }\n      /**\n       * When a property is changed, this callback function is called.\n       * @param name name of the property\n       * @param oldValue value before change\n       * @param newValue value after change\n       */\n\n\n      propertyChangedCallback(name, oldValue, newValue) {\n        if (!this.hasConnected) {\n          return;\n        }\n\n        if (oldValue === newValue) {\n          return;\n        }\n\n        this.properties[name] = newValue;\n        this.mountReactApp();\n      }\n      /**\n       * Web Component gets unmounted from the DOM.\n       */\n\n\n      disconnectedCallback() {\n        ReactDOM.unmountComponentAtNode(this);\n      }\n      /**\n       * Setup getters and setters for all properties.\n       * Here we ensure that the 'propertyChangedCallback' will get invoked\n       * when a property changes.\n       */\n\n\n      subscribeToProperties() {\n        const propertyMap = {};\n        Object.keys(this.initialProperties).forEach(key => {\n          propertyMap[key] = {\n            configurable: true,\n            enumerable: true,\n            get: () => {\n              const currentValue = this.properties.hasOwnProperty(key) ? this.properties[key] : this.initialProperties[key];\n              return currentValue;\n            },\n            set: newValue => {\n              const oldValue = this.properties.hasOwnProperty(key) ? this.properties[key] : this.initialProperties[key];\n              this.propertyChangedCallback(key, oldValue, newValue);\n            }\n          };\n        });\n        Object.defineProperties(this, propertyMap);\n      }\n      /**\n       * Syncronize all properties and attributes\n       */\n\n\n      syncronizePropertiesAndAttributes() {\n        Object.keys(this.initialProperties).forEach(key => {\n          if (this.properties.hasOwnProperty(key)) {\n            return;\n          }\n\n          if (this.getAttribute(key) !== null) {\n            this.properties[key] = getSerialized(this.getAttribute(key));\n            return;\n          }\n\n          this.properties[key] = this.initialProperties[key];\n        });\n      }\n      /**\n       * Transfer initial properties from the custom element.\n       */\n\n\n      transferInitialProperties() {\n        Object.keys(this.initialProperties).forEach(key => {\n          if (this.hasOwnProperty(key)) {\n            this.properties[key] = this[key];\n          }\n        });\n      }\n      /**\n       * Apply plugins\n       */\n\n\n      applyPlugins(application) {\n        const shadowChildren = [];\n        const applicationWithPlugins = registeredPlugins.reduce((app, currentPlugin) => {\n          const pluginResult = currentPlugin(this, factory.plugins, app);\n\n          if (!pluginResult) {\n            return app;\n          }\n\n          const [wrapper, shadowChild] = pluginResult;\n\n          if (shadowChild) {\n            shadowChildren.push(shadowChild);\n          }\n\n          return wrapper;\n        }, application);\n        return [applicationWithPlugins, shadowChildren];\n      }\n      /**\n       * Generate react props based on properties and attributes.\n       */\n\n\n      reactProps() {\n        this.syncronizePropertiesAndAttributes();\n        return this.properties;\n      }\n      /**\n       * Mount React App onto the Web Component\n       */\n\n\n      mountReactApp(options) {\n        const anonymousSlot = factory.anonymousSlot ? React.createElement('slot') : undefined;\n        const application = React.createElement(EventProvider, {\n          value: this.eventDispatcher\n        }, React.createElement(factory.rootComponent, this.reactProps(), anonymousSlot));\n        const [applicationWithPlugins, shadowChildren] = this.applyPlugins(application);\n\n        if (!factory.shadow) {\n          ReactDOM.render(applicationWithPlugins, this);\n          return;\n        }\n\n        let currentChildren;\n\n        if (options === null || options === void 0 ? void 0 : options.initial) {\n          currentChildren = Array.from(this.children).map(child => child.cloneNode(true));\n        }\n\n        const root = createProxyRoot(this, shadowChildren);\n        ReactDOM.render(React.createElement(root.open, null, applicationWithPlugins), this);\n\n        if (currentChildren) {\n          currentChildren.forEach(child => this.append(child));\n        }\n      }\n\n    };\n  }\n\n}\n\nexport default WebComponentFactory;","map":{"version":3,"sources":["/home/taras/dev/lp-button/node_modules/direflow-component/dist/WebComponentFactory.js"],"names":["React","ReactDOM","clonedeep","createProxyRoot","EventProvider","registeredPlugins","getSerialized","WebComponentFactory","constructor","componentProperties","rootComponent","shadow","anonymousSlot","plugins","connectCallback","componentAttributes","reflectPropertiesToAttributes","Object","entries","forEach","key","value","toLowerCase","property","create","factory","WebComponent","HTMLElement","initialProperties","properties","hasConnected","eventDispatcher","event","dispatchEvent","transferInitialProperties","subscribeToProperties","observedAttributes","keys","connectedCallback","_a","mountReactApp","initial","call","attributeChangedCallback","name","oldValue","newValue","hasOwnProperty","propertyName","propertyChangedCallback","disconnectedCallback","unmountComponentAtNode","propertyMap","configurable","enumerable","get","currentValue","set","defineProperties","syncronizePropertiesAndAttributes","getAttribute","applyPlugins","application","shadowChildren","applicationWithPlugins","reduce","app","currentPlugin","pluginResult","wrapper","shadowChild","push","reactProps","options","createElement","undefined","render","currentChildren","Array","from","children","map","child","cloneNode","root","open","append"],"mappings":"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","sourcesContent":["/* eslint-disable class-methods-use-this */\n/* eslint-disable max-classes-per-file */\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport clonedeep from 'lodash.clonedeep';\nimport createProxyRoot from './helpers/proxyRoot';\nimport { EventProvider } from './components/EventContext';\nimport registeredPlugins from './plugins/plugins';\nimport getSerialized from './helpers/getSerialized';\nclass WebComponentFactory {\n    constructor(componentProperties, rootComponent, shadow, anonymousSlot, plugins, connectCallback) {\n        this.componentProperties = componentProperties;\n        this.rootComponent = rootComponent;\n        this.shadow = shadow;\n        this.anonymousSlot = anonymousSlot;\n        this.plugins = plugins;\n        this.connectCallback = connectCallback;\n        this.componentAttributes = {};\n        this.reflectPropertiesToAttributes();\n    }\n    /**\n     * All properties with primitive values are added to attributes.\n     */\n    reflectPropertiesToAttributes() {\n        Object.entries(this.componentProperties).forEach(([key, value]) => {\n            if (typeof value !== 'number' && typeof value !== 'string' && typeof value !== 'boolean') {\n                return;\n            }\n            this.componentAttributes[key.toLowerCase()] = {\n                property: key,\n                value,\n            };\n        });\n    }\n    /**\n     * Create new class that will serve as the Web Component.\n     */\n    create() {\n        const factory = this;\n        return class WebComponent extends HTMLElement {\n            constructor() {\n                super();\n                this.initialProperties = clonedeep(factory.componentProperties);\n                this.properties = {};\n                this.hasConnected = false;\n                /**\n                 * Dispatch an event from the Web Component\n                 */\n                this.eventDispatcher = (event) => {\n                    this.dispatchEvent(event);\n                };\n                this.transferInitialProperties();\n                this.subscribeToProperties();\n            }\n            /**\n             * Observe attributes for changes.\n             * Part of the Web Component Standard.\n             */\n            static get observedAttributes() {\n                return Object.keys(factory.componentAttributes);\n            }\n            /**\n             * Web Component gets mounted on the DOM.\n             */\n            connectedCallback() {\n                var _a;\n                this.mountReactApp({ initial: true });\n                this.hasConnected = true;\n                (_a = factory.connectCallback) === null || _a === void 0 ? void 0 : _a.call(factory, this);\n            }\n            /**\n             * When an attribute is changed, this callback function is called.\n             * @param name name of the attribute\n             * @param oldValue value before change\n             * @param newValue value after change\n             */\n            attributeChangedCallback(name, oldValue, newValue) {\n                if (!this.hasConnected) {\n                    return;\n                }\n                if (oldValue === newValue) {\n                    return;\n                }\n                if (!factory.componentAttributes.hasOwnProperty(name)) {\n                    return;\n                }\n                const propertyName = factory.componentAttributes[name].property;\n                this.properties[propertyName] = getSerialized(newValue);\n                this.mountReactApp();\n            }\n            /**\n             * When a property is changed, this callback function is called.\n             * @param name name of the property\n             * @param oldValue value before change\n             * @param newValue value after change\n             */\n            propertyChangedCallback(name, oldValue, newValue) {\n                if (!this.hasConnected) {\n                    return;\n                }\n                if (oldValue === newValue) {\n                    return;\n                }\n                this.properties[name] = newValue;\n                this.mountReactApp();\n            }\n            /**\n             * Web Component gets unmounted from the DOM.\n             */\n            disconnectedCallback() {\n                ReactDOM.unmountComponentAtNode(this);\n            }\n            /**\n             * Setup getters and setters for all properties.\n             * Here we ensure that the 'propertyChangedCallback' will get invoked\n             * when a property changes.\n             */\n            subscribeToProperties() {\n                const propertyMap = {};\n                Object.keys(this.initialProperties).forEach((key) => {\n                    propertyMap[key] = {\n                        configurable: true,\n                        enumerable: true,\n                        get: () => {\n                            const currentValue = this.properties.hasOwnProperty(key)\n                                ? this.properties[key]\n                                : this.initialProperties[key];\n                            return currentValue;\n                        },\n                        set: (newValue) => {\n                            const oldValue = this.properties.hasOwnProperty(key)\n                                ? this.properties[key]\n                                : this.initialProperties[key];\n                            this.propertyChangedCallback(key, oldValue, newValue);\n                        },\n                    };\n                });\n                Object.defineProperties(this, propertyMap);\n            }\n            /**\n             * Syncronize all properties and attributes\n             */\n            syncronizePropertiesAndAttributes() {\n                Object.keys(this.initialProperties).forEach((key) => {\n                    if (this.properties.hasOwnProperty(key)) {\n                        return;\n                    }\n                    if (this.getAttribute(key) !== null) {\n                        this.properties[key] = getSerialized(this.getAttribute(key));\n                        return;\n                    }\n                    this.properties[key] = this.initialProperties[key];\n                });\n            }\n            /**\n             * Transfer initial properties from the custom element.\n             */\n            transferInitialProperties() {\n                Object.keys(this.initialProperties).forEach((key) => {\n                    if (this.hasOwnProperty(key)) {\n                        this.properties[key] = this[key];\n                    }\n                });\n            }\n            /**\n             * Apply plugins\n             */\n            applyPlugins(application) {\n                const shadowChildren = [];\n                const applicationWithPlugins = registeredPlugins.reduce((app, currentPlugin) => {\n                    const pluginResult = currentPlugin(this, factory.plugins, app);\n                    if (!pluginResult) {\n                        return app;\n                    }\n                    const [wrapper, shadowChild] = pluginResult;\n                    if (shadowChild) {\n                        shadowChildren.push(shadowChild);\n                    }\n                    return wrapper;\n                }, application);\n                return [applicationWithPlugins, shadowChildren];\n            }\n            /**\n             * Generate react props based on properties and attributes.\n             */\n            reactProps() {\n                this.syncronizePropertiesAndAttributes();\n                return this.properties;\n            }\n            /**\n             * Mount React App onto the Web Component\n             */\n            mountReactApp(options) {\n                const anonymousSlot = factory.anonymousSlot ? React.createElement('slot') : undefined;\n                const application = (React.createElement(EventProvider, { value: this.eventDispatcher }, React.createElement(factory.rootComponent, this.reactProps(), anonymousSlot)));\n                const [applicationWithPlugins, shadowChildren] = this.applyPlugins(application);\n                if (!factory.shadow) {\n                    ReactDOM.render(applicationWithPlugins, this);\n                    return;\n                }\n                let currentChildren;\n                if (options === null || options === void 0 ? void 0 : options.initial) {\n                    currentChildren = Array.from(this.children).map((child) => child.cloneNode(true));\n                }\n                const root = createProxyRoot(this, shadowChildren);\n                ReactDOM.render(React.createElement(root.open, null, applicationWithPlugins), this);\n                if (currentChildren) {\n                    currentChildren.forEach((child) => this.append(child));\n                }\n            }\n        };\n    }\n}\nexport default WebComponentFactory;\n"]},"metadata":{},"sourceType":"module"}